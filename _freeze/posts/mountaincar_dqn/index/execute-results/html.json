{
  "hash": "4e3d1aeb5498dd30fcaa3df97267f816",
  "result": {
    "markdown": "---\ntitle: \"Driving Up A Mountain\"\ndescription: \"Solve OpenAI's MountainCar-v0 environment with a deep Q network.\"\nauthor: \"John King\"\ndate: \"4/11/2020\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-tools: true\n    code-copy: true\n    df-print: paged\nexecute: \n  warning: false\n  message: false\ncategories:\n  - python\n  - reinforcement learning\n  - OpenAI\n  - tensorflow\n  - neural network\nimage: \"mc.png\"\n---\n\nA while back, I found OpenAI's [Gym environments](https://gym.openai.com/) and immediately wanted to try to solve one. I didn't really know what I was doing at the time, so I went back to the basics for a better understanding of [Q-learning](https://jfking.netlify.app/posts/qlearning/) and [Deep Q-Networks](https://jfking.netlify.app/blog/dqn-ttt/). Now I think I'm ready to graduate from tic-tac-toe and try a Gym environment again. Best to start simple, though.\n\n## The MountainCar Environment\n\nThere are two Mountain Car environments: one with a discrete number of actions, and one with a continuous range of actions. Keeping it simple means go with the discrete case. The Gym documentation describes the situation and the goal:\n\n> A car is on a one-dimensional track, positioned between two \"mountains\". The goal is to drive up the mountain on the right; however, the car's engine is not strong enough to scale the mountain in a single pass. Therefore, the only way to succeed is to drive back and forth to build up momentum.\n\n![MountainCar](mc.png){width=\"300\"}\n\nOne of the nice things about working with Gym environments is that I don't have to put effort into defining my own environment like I did with tic-tac-toe. All I have to do to create the mountain car environment is `gym.make('MountainCar-v0')`. It's that easy! I need to get some information about the **state space and actions** so I know what I'm dealing with. First the state space.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport gym\nenv = gym.make('MountainCar-v0')\nprint(env.observation_space)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nBox([-1.2  -0.07], [0.6  0.07], (2,), float32)\n```\n:::\n:::\n\n\n`Box` means that it's a continuous state space, and the (2,) means there are two numbers that represent the state space. The two lists represent the low and high limits of the state space. Going back to the documentation, the state represents the position and velocity of the car in that order. In other words, the position can be between -1.2 and 0.6, and the velocity can be between -0.07 and 0.07.\n\nThe documentation states that an episode ends the car reaches 0.5 position, or if 200 iterations are reached. That means the position value is the x-axis with positive values to the right, and that a positive velocity means the car is moving to the right. The documentation also says that the starting state is a random position from -0.6 to -0.4 with no velocity, so the car starts at the bottom of the valley at a stand still. Makes sense. What do I have for actions?\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nprint(env.action_space)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nDiscrete(3)\n```\n:::\n:::\n\n\nThree possible actions. 0 means push left, 1 means do nothing (not sure why you'd ever do that), and 2 means push right.\n\nLast thing I need is how the **rewards** work. They say you get \"-1 for each time step until the goal position of 0.5 is reached\". So there's no positive reward? Huh. They also say \"there is no penalty for climbing the left hill, which upon reached acts as a wall\". I guess that means the car can bounce off it without crashing.\n\nTo **interact with the environment**, I first need to reset it with `env.reset()`. This gives me the car's starting state. Then I need an action. I can get a random action from the environment with `env.action_space.sample()`, or I could just use `numpy` to generate a random number. Anyway, then to execute that action in the environment, I use `env.step(action)`. This returns the next observation based on that action, the reward (always -1), whether the episode is over, and some empty information. Also according to the docs, I should close the environment when I'm done with it. Here I'll take 5 random actions to see what things look like.\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nobservation = env.reset()\nprint(\"observation:\", observation)\nfor t in range(5):\n    action = env.action_space.sample()\n    print(\"action:\", action)\n    observation, reward, done, info, empty = env.step(action)\n    print(\"step results:\", observation, reward, done, info)\nenv.close()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nobservation: (array([-0.5010359,  0.       ], dtype=float32), {})\naction: 1\nstep results: [-5.012050e-01 -1.690923e-04] -1.0 False False\naction: 2\nstep results: [-0.5005419   0.00066308] -1.0 False False\naction: 1\nstep results: [-5.000516e-01  4.902922e-04] -1.0 False False\naction: 0\nstep results: [-0.5007378  -0.00068616] -1.0 False False\naction: 1\nstep results: [-0.50159526 -0.00085749] -1.0 False False\n```\n:::\n:::\n\n\nOk, got it. I'll import a bunch of stuff and then get to solving this thing with a DQN agent.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\nimport numpy as np\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom collections import deque\n```\n:::\n\n\n## DQN Agent\n\nIf you read my last post on [deep Q-networks](https://jfking.netlify/blog/dqn-ttt/), a lot of this will look familiar. I'm only going to explain what's different, so you might want to go back and read it.\n\n**`build_model`**: The only thing I changed here was to reduce the number of nodes in the two hidden layers. Since there are only two values that represent the state and only three actions, 32 nodes seemed plenty.\n\n**`add_memory`**: This is completely new. What I'm doing here is storing information about every step (an \"experience\") to create what's referred to as a replay memory. In the `__init__` function, I create a deque of length 2000 for this purpose. This function simply adds an experience to the replay memory. Since it's a deque, once it contains 2000 items, adding a new item to the top of the queue will cause the oldest item to be removed.\n\n**`sample_experiences`**: This is also new and is part of the replay memory implementation. This function is called only after the replay memory deque is full. Here I randomly sample 64 experiences (defined by `batch_size`) from the replay memory. According to [Aurélien Géron](https://www.amazon.com/Hands-Machine-Learning-Scikit-Learn-TensorFlow/dp/1492032646),\n\n> This helps reduce the correlations between the experiences in a training batch, which tremendously helps training.\n\n**`train_model`**: The only thing different here is the implementation of training from memory replay via `self.sample_experiences()` instead of training based on the full set of experiences. Otherwise, the neural net is trained exactly the same way as it did for the tic-tac-toe example. Although not strictly part of this function, I also switched from a stochastic gradient decent optimizer to an Adam optimizer and decreased the learning rate to 0.001 in the `__init__` function.\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\nclass DQNagent:\n\n    def __init__(self, state_size, action_size, episodes):\n        self.gamma = 0.95\n        self.batch_size = 64\n        self.state_size = state_size\n        self.action_size = action_size\n        self.episodes = episodes\n        self.replay_memory = deque(maxlen=2000)\n        self.optimizer = tf.keras.optimizers.Adam(learning_rate=0.001)\n        self.loss_fn = tf.keras.losses.mean_squared_error\n\n    def build_model(self):\n        model = tf.keras.models.Sequential([\n            tf.keras.layers.Dense(32, activation=\"relu\", input_shape=[self.state_size]),\n            tf.keras.layers.Dense(32, activation=\"relu\"),\n            tf.keras.layers.Dense(self.action_size)\n        ])\n        return model\n\n    def add_memory(self, state, action, reward, next_state, done):\n        self.replay_memory.append((state, action, reward, next_state, done))\n\n    def sample_experiences(self):\n        indices = np.random.randint(len(self.replay_memory), size=self.batch_size)\n        batch = [self.replay_memory[index] for index in indices]\n        states, actions, rewards, next_states, dones = [\n            np.array([experience[field_index] for experience in batch])\n            for field_index in range(5)]\n        return states, actions, rewards, next_states, dones\n\n    def train_model(self, model):\n        states, actions, rewards, next_states, dones = self.sample_experiences()\n        next_Q_values = model.predict(next_states, verbose=0)\n        max_next_Q_values = np.max(next_Q_values, axis=1)\n        target_Q_values = (rewards + (1 - dones) * self.gamma * max_next_Q_values)\n        target_Q_values = target_Q_values.reshape(-1, 1)\n        mask = tf.one_hot(actions, self.action_size)\n        with tf.GradientTape() as tape:\n            all_Q_values = model(states)\n            Q_values = tf.reduce_sum(all_Q_values * mask, axis=1, keepdims=True)\n            loss = tf.reduce_mean(self.loss_fn(target_Q_values, Q_values))\n        grads = tape.gradient(loss, model.trainable_variables)\n        self.optimizer.apply_gradients(zip(grads, model.trainable_variables))\n```\n:::\n\n\n## Let The Training Begin\n\nThis problem kicked my butt for quite a while. I *could not* get that stupid car up the hill! It seemed so simple, but I was stumped. I actually solved this early on with a simple hard-coded policy: if the car is moving left (a negative velocity), push left. Otherwise, push right. Done. Didn't even need a neural net, q-learning, or anything. So why bother with solving this with reinforcement learning? I guess in the real world I wouldn't, but the point here is to see if I can train a neural net (NN) to learn that policy.\n\n### I Tried A Lot Of Things That Didn't Work\n\nFirst, I left everything as is, and just fed experiences to the NN hoping it would learn. Recall that each episode consists of 200 steps, and so you get a -1 reward for each step for a total reward of -200. If the car reaches the goal in say 150 steps, then you get a total reward of -150. My idea here was that the NN would learn to maximize the total reward by finishing in under 200 steps. Nope. Never happened. The car never got to the goal during training and so the NN never learned anything.\n\nThen I started thinking about the reward system. It seemed like I needed to give the NN some positive reward to encourage it along. I tried giving a small positive reward if the car made it some distance away from the range of possible starting points. That ended up teaching the NN to drive up and down the same side of the hill over and over. Clearly, the statement, \"the only way to succeed is to drive back and forth to build up momentum\" is correct, but how do I do that? I tried a one-time positive reward on one side of the hill and only gave additional rewards if the car then tried going up the other side of the hill. That didn't work, either. I tried giving a huge reward if the car ever made it to the goal position, hoping that would back-propagate quickly through the NN weights. Still nope.\n\nIt seemed like this reward system I was creating was getting a lot more complicated that it should need to be, so then I tried all of the above while at the same time adjusting the tuning parameters: learning rate, discount rate, and epsilon. No luck. I tried fiddling with how the NN was constructed: number of hidden layers, nodes, etc. Nope. I also tried changing the replay memory batch size. I even took memory replay completely out of the algorithm thinking that maybe that rare time the car made it to the goal kept getting missed in the random draw from the memory replay. Nope again.\n\n### What Did Work\n\nIt dawned on me that maybe I should just come up with a reward system that mimicked the hard-coded policy I described earlier. Finally, that worked! In the code below, you'll see:\n\n-   `if next_state[0] - state[0] > 0 and action == 2: reward = 1` moving right and pushing right = a reward\n-   `if next_state[0] - state[0] < 0 and action == 0: reward = 1` moving left and pushing left = a reward\n\nThe following code trans the NN for 600 episodes and keeps track of the best score. I define the score as the number of steps it takes to reach the goal, so the fewer, the better. When a new best score is reached, I save the model weights as `best_weights`. After the 600th episode is over, I reset the model weights with the best weights. Why? It turns out that learning is hard, and forgetting is easy, which I'll demonstrate shortly.\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\nbest_score = 200\nepisodes = 600\nenv = gym.make('MountainCar-v0')\nstate_size = env.observation_space.shape[0]\naction_size = env.action_space.n\nagent = DQNagent(state_size, action_size, episodes)\nmodel = agent.build_model()\nrewards = []\n\nfor episode in range(episodes):\n    state = env.reset()[0]\n    for step in range(200):\n        epsilon = max(1 - episode/(episodes*0.8), 0.01)\n        if np.random.rand() < epsilon: action = np.random.randint(action_size)\n        else: action = np.argmax(model.predict(state[np.newaxis], verbose = 0)[0])\n        next_state, reward, done, info, empty = env.step(action)\n        if next_state[0] - state[0] > 0 and action == 2: reward = 1\n        if next_state[0] - state[0] < 0 and action == 0: reward = 1        \n        agent.add_memory(state, action, reward, next_state, done)\n        state = next_state.copy()\n        if done:\n            break\n    rewards.append(step)\n    if step < best_score:\n        best_weights = model.get_weights()\n        best_score = step\n    print(\"\\rEpisode: {}, Best Score: {}, eps: {:.3f}\".format(episode, best_score, epsilon), end=\"\")\n    if episode > 50:\n        agent.train_model(model)\n\nmodel.set_weights(best_weights)\n\nenv.close()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 0, Best Score: 199, eps: 1.000\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 1, Best Score: 199, eps: 0.998\rEpisode: 2, Best Score: 199, eps: 0.996\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 3, Best Score: 199, eps: 0.994\rEpisode: 4, Best Score: 199, eps: 0.992\rEpisode: 5, Best Score: 199, eps: 0.990\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 6, Best Score: 199, eps: 0.988\rEpisode: 7, Best Score: 199, eps: 0.985\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 8, Best Score: 199, eps: 0.983\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 9, Best Score: 199, eps: 0.981\rEpisode: 10, Best Score: 199, eps: 0.979\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 11, Best Score: 199, eps: 0.977\rEpisode: 12, Best Score: 199, eps: 0.975\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 13, Best Score: 199, eps: 0.973\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 14, Best Score: 199, eps: 0.971\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 15, Best Score: 199, eps: 0.969\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 16, Best Score: 199, eps: 0.967\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 17, Best Score: 199, eps: 0.965\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 18, Best Score: 199, eps: 0.963\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 19, Best Score: 199, eps: 0.960\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 20, Best Score: 199, eps: 0.958\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 21, Best Score: 199, eps: 0.956\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 22, Best Score: 199, eps: 0.954\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 23, Best Score: 199, eps: 0.952\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 24, Best Score: 199, eps: 0.950\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 25, Best Score: 199, eps: 0.948\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 26, Best Score: 199, eps: 0.946\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 27, Best Score: 199, eps: 0.944\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 28, Best Score: 199, eps: 0.942\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 29, Best Score: 199, eps: 0.940\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 30, Best Score: 199, eps: 0.938\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 31, Best Score: 199, eps: 0.935\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 32, Best Score: 199, eps: 0.933\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 33, Best Score: 199, eps: 0.931\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 34, Best Score: 199, eps: 0.929\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 35, Best Score: 199, eps: 0.927\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 36, Best Score: 199, eps: 0.925\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 37, Best Score: 199, eps: 0.923\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 38, Best Score: 199, eps: 0.921\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 39, Best Score: 199, eps: 0.919\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 40, Best Score: 199, eps: 0.917\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 41, Best Score: 199, eps: 0.915\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 42, Best Score: 199, eps: 0.912\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 43, Best Score: 199, eps: 0.910\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 44, Best Score: 199, eps: 0.908\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 45, Best Score: 199, eps: 0.906\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 46, Best Score: 199, eps: 0.904\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 47, Best Score: 199, eps: 0.902\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 48, Best Score: 199, eps: 0.900\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 49, Best Score: 199, eps: 0.898\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 50, Best Score: 199, eps: 0.896\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 51, Best Score: 199, eps: 0.894\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 52, Best Score: 199, eps: 0.892\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 53, Best Score: 199, eps: 0.890\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 54, Best Score: 199, eps: 0.887\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 55, Best Score: 199, eps: 0.885\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 56, Best Score: 199, eps: 0.883\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 57, Best Score: 199, eps: 0.881\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 58, Best Score: 199, eps: 0.879\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 59, Best Score: 199, eps: 0.877\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 60, Best Score: 199, eps: 0.875\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 61, Best Score: 199, eps: 0.873\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 62, Best Score: 199, eps: 0.871\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 63, Best Score: 199, eps: 0.869\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 64, Best Score: 199, eps: 0.867\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 65, Best Score: 199, eps: 0.865\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 66, Best Score: 199, eps: 0.863\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 67, Best Score: 199, eps: 0.860\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 68, Best Score: 199, eps: 0.858\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 69, Best Score: 199, eps: 0.856\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 70, Best Score: 199, eps: 0.854\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 71, Best Score: 199, eps: 0.852\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 72, Best Score: 199, eps: 0.850\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 73, Best Score: 199, eps: 0.848\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 74, Best Score: 199, eps: 0.846\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 75, Best Score: 199, eps: 0.844\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 76, Best Score: 199, eps: 0.842\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 77, Best Score: 199, eps: 0.840\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 78, Best Score: 199, eps: 0.838\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 79, Best Score: 199, eps: 0.835\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 80, Best Score: 199, eps: 0.833\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 81, Best Score: 199, eps: 0.831\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 82, Best Score: 199, eps: 0.829\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 83, Best Score: 199, eps: 0.827\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 84, Best Score: 199, eps: 0.825\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 85, Best Score: 199, eps: 0.823\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 86, Best Score: 199, eps: 0.821\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 87, Best Score: 199, eps: 0.819\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 88, Best Score: 199, eps: 0.817\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 89, Best Score: 199, eps: 0.815\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 90, Best Score: 199, eps: 0.812\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 91, Best Score: 199, eps: 0.810\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 92, Best Score: 199, eps: 0.808\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 93, Best Score: 199, eps: 0.806\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 94, Best Score: 199, eps: 0.804\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 95, Best Score: 199, eps: 0.802\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 96, Best Score: 199, eps: 0.800\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 97, Best Score: 199, eps: 0.798\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 98, Best Score: 199, eps: 0.796\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 99, Best Score: 199, eps: 0.794\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 100, Best Score: 199, eps: 0.792\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 101, Best Score: 199, eps: 0.790\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 102, Best Score: 199, eps: 0.787\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 103, Best Score: 199, eps: 0.785\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 104, Best Score: 199, eps: 0.783\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 105, Best Score: 199, eps: 0.781\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 106, Best Score: 199, eps: 0.779\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 107, Best Score: 199, eps: 0.777\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 108, Best Score: 199, eps: 0.775\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 109, Best Score: 199, eps: 0.773\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 110, Best Score: 199, eps: 0.771\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 111, Best Score: 199, eps: 0.769\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 112, Best Score: 199, eps: 0.767\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 113, Best Score: 199, eps: 0.765\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 114, Best Score: 199, eps: 0.762\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 115, Best Score: 199, eps: 0.760\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 116, Best Score: 199, eps: 0.758\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 117, Best Score: 199, eps: 0.756\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 118, Best Score: 199, eps: 0.754\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 119, Best Score: 199, eps: 0.752\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 120, Best Score: 199, eps: 0.750\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 121, Best Score: 199, eps: 0.748\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 122, Best Score: 199, eps: 0.746\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 123, Best Score: 199, eps: 0.744\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 124, Best Score: 199, eps: 0.742\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 125, Best Score: 199, eps: 0.740\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 126, Best Score: 199, eps: 0.738\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 127, Best Score: 199, eps: 0.735\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 128, Best Score: 199, eps: 0.733\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 129, Best Score: 199, eps: 0.731\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 130, Best Score: 199, eps: 0.729\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 131, Best Score: 199, eps: 0.727\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 132, Best Score: 199, eps: 0.725\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 133, Best Score: 199, eps: 0.723\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 134, Best Score: 199, eps: 0.721\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 135, Best Score: 199, eps: 0.719\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 136, Best Score: 199, eps: 0.717\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 137, Best Score: 199, eps: 0.715\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 138, Best Score: 199, eps: 0.713\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 139, Best Score: 199, eps: 0.710\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 140, Best Score: 199, eps: 0.708\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 141, Best Score: 199, eps: 0.706\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 142, Best Score: 199, eps: 0.704\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 143, Best Score: 199, eps: 0.702\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 144, Best Score: 199, eps: 0.700\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 145, Best Score: 199, eps: 0.698\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 146, Best Score: 199, eps: 0.696\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 147, Best Score: 199, eps: 0.694\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 148, Best Score: 199, eps: 0.692\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 149, Best Score: 199, eps: 0.690\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 150, Best Score: 199, eps: 0.688\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 151, Best Score: 199, eps: 0.685\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 152, Best Score: 199, eps: 0.683\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 153, Best Score: 199, eps: 0.681\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 154, Best Score: 199, eps: 0.679\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 155, Best Score: 199, eps: 0.677\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 156, Best Score: 199, eps: 0.675\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 157, Best Score: 199, eps: 0.673\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 158, Best Score: 199, eps: 0.671\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 159, Best Score: 199, eps: 0.669\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 160, Best Score: 199, eps: 0.667\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 161, Best Score: 199, eps: 0.665\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 162, Best Score: 199, eps: 0.662\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 163, Best Score: 199, eps: 0.660\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 164, Best Score: 199, eps: 0.658\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 165, Best Score: 199, eps: 0.656\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 166, Best Score: 199, eps: 0.654\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 167, Best Score: 199, eps: 0.652\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 168, Best Score: 199, eps: 0.650\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 169, Best Score: 199, eps: 0.648\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 170, Best Score: 199, eps: 0.646\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 171, Best Score: 199, eps: 0.644\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 172, Best Score: 199, eps: 0.642\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 173, Best Score: 199, eps: 0.640\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 174, Best Score: 199, eps: 0.637\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 175, Best Score: 199, eps: 0.635\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 176, Best Score: 199, eps: 0.633\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 177, Best Score: 199, eps: 0.631\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 178, Best Score: 199, eps: 0.629\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 179, Best Score: 199, eps: 0.627\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 180, Best Score: 199, eps: 0.625\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 181, Best Score: 199, eps: 0.623\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 182, Best Score: 199, eps: 0.621\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 183, Best Score: 199, eps: 0.619\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 184, Best Score: 199, eps: 0.617\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 185, Best Score: 199, eps: 0.615\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 186, Best Score: 199, eps: 0.613\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 187, Best Score: 199, eps: 0.610\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 188, Best Score: 199, eps: 0.608\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 189, Best Score: 199, eps: 0.606\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 190, Best Score: 199, eps: 0.604\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 191, Best Score: 199, eps: 0.602\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 192, Best Score: 199, eps: 0.600\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 193, Best Score: 199, eps: 0.598\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 194, Best Score: 199, eps: 0.596\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 195, Best Score: 199, eps: 0.594\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 196, Best Score: 199, eps: 0.592\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 197, Best Score: 199, eps: 0.590\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 198, Best Score: 199, eps: 0.588\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 199, Best Score: 199, eps: 0.585\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 200, Best Score: 199, eps: 0.583\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 201, Best Score: 199, eps: 0.581\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 202, Best Score: 199, eps: 0.579\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 203, Best Score: 199, eps: 0.577\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 204, Best Score: 199, eps: 0.575\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 205, Best Score: 199, eps: 0.573\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 206, Best Score: 199, eps: 0.571\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 207, Best Score: 199, eps: 0.569\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 208, Best Score: 199, eps: 0.567\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 209, Best Score: 199, eps: 0.565\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 210, Best Score: 199, eps: 0.562\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 211, Best Score: 199, eps: 0.560\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 212, Best Score: 199, eps: 0.558\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 213, Best Score: 199, eps: 0.556\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 214, Best Score: 199, eps: 0.554\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 215, Best Score: 199, eps: 0.552\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 216, Best Score: 199, eps: 0.550\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 217, Best Score: 199, eps: 0.548\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 218, Best Score: 199, eps: 0.546\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 219, Best Score: 199, eps: 0.544\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 220, Best Score: 199, eps: 0.542\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 221, Best Score: 199, eps: 0.540\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 222, Best Score: 199, eps: 0.537\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 223, Best Score: 199, eps: 0.535\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 224, Best Score: 199, eps: 0.533\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 225, Best Score: 199, eps: 0.531\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 226, Best Score: 199, eps: 0.529\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 227, Best Score: 199, eps: 0.527\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 228, Best Score: 199, eps: 0.525\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 229, Best Score: 199, eps: 0.523\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 230, Best Score: 199, eps: 0.521\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 231, Best Score: 199, eps: 0.519\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 232, Best Score: 199, eps: 0.517\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 233, Best Score: 199, eps: 0.515\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 234, Best Score: 199, eps: 0.512\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 235, Best Score: 199, eps: 0.510\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 236, Best Score: 199, eps: 0.508\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 237, Best Score: 199, eps: 0.506\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 238, Best Score: 199, eps: 0.504\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 239, Best Score: 199, eps: 0.502\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 240, Best Score: 199, eps: 0.500\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 241, Best Score: 199, eps: 0.498\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 242, Best Score: 199, eps: 0.496\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 243, Best Score: 199, eps: 0.494\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 244, Best Score: 199, eps: 0.492\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 245, Best Score: 199, eps: 0.490\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 246, Best Score: 199, eps: 0.488\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 247, Best Score: 199, eps: 0.485\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 248, Best Score: 199, eps: 0.483\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 249, Best Score: 199, eps: 0.481\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 250, Best Score: 199, eps: 0.479\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 251, Best Score: 199, eps: 0.477\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 252, Best Score: 199, eps: 0.475\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 253, Best Score: 199, eps: 0.473\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 254, Best Score: 199, eps: 0.471\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 255, Best Score: 199, eps: 0.469\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 256, Best Score: 199, eps: 0.467\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 257, Best Score: 199, eps: 0.465\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 258, Best Score: 199, eps: 0.463\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 259, Best Score: 199, eps: 0.460\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 260, Best Score: 199, eps: 0.458\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 261, Best Score: 199, eps: 0.456\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 262, Best Score: 199, eps: 0.454\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 263, Best Score: 199, eps: 0.452\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 264, Best Score: 199, eps: 0.450\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 265, Best Score: 199, eps: 0.448\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 266, Best Score: 199, eps: 0.446\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 267, Best Score: 199, eps: 0.444\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 268, Best Score: 199, eps: 0.442\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 269, Best Score: 199, eps: 0.440\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 270, Best Score: 199, eps: 0.438\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 271, Best Score: 199, eps: 0.435\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 272, Best Score: 199, eps: 0.433\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 273, Best Score: 199, eps: 0.431\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 274, Best Score: 199, eps: 0.429\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 275, Best Score: 199, eps: 0.427\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 276, Best Score: 199, eps: 0.425\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 277, Best Score: 199, eps: 0.423\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 278, Best Score: 199, eps: 0.421\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 279, Best Score: 199, eps: 0.419\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 280, Best Score: 199, eps: 0.417\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 281, Best Score: 199, eps: 0.415\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 282, Best Score: 199, eps: 0.412\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 283, Best Score: 199, eps: 0.410\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 284, Best Score: 199, eps: 0.408\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 285, Best Score: 199, eps: 0.406\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 286, Best Score: 199, eps: 0.404\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 287, Best Score: 199, eps: 0.402\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 288, Best Score: 199, eps: 0.400\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 289, Best Score: 199, eps: 0.398\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 290, Best Score: 199, eps: 0.396\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 291, Best Score: 199, eps: 0.394\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 292, Best Score: 199, eps: 0.392\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 293, Best Score: 199, eps: 0.390\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 294, Best Score: 199, eps: 0.387\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 295, Best Score: 199, eps: 0.385\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 296, Best Score: 199, eps: 0.383\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 297, Best Score: 199, eps: 0.381\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 298, Best Score: 199, eps: 0.379\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 299, Best Score: 199, eps: 0.377\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 300, Best Score: 199, eps: 0.375\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 301, Best Score: 199, eps: 0.373\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 302, Best Score: 199, eps: 0.371\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 303, Best Score: 199, eps: 0.369\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 304, Best Score: 199, eps: 0.367\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 305, Best Score: 199, eps: 0.365\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 306, Best Score: 199, eps: 0.363\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 307, Best Score: 199, eps: 0.360\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 308, Best Score: 199, eps: 0.358\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 309, Best Score: 199, eps: 0.356\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 310, Best Score: 199, eps: 0.354\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 311, Best Score: 199, eps: 0.352\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 312, Best Score: 199, eps: 0.350\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 313, Best Score: 199, eps: 0.348\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 314, Best Score: 199, eps: 0.346\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 315, Best Score: 199, eps: 0.344\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 316, Best Score: 199, eps: 0.342\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 317, Best Score: 199, eps: 0.340\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 318, Best Score: 199, eps: 0.338\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 319, Best Score: 199, eps: 0.335\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 320, Best Score: 199, eps: 0.333\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 321, Best Score: 199, eps: 0.331\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 322, Best Score: 199, eps: 0.329\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 323, Best Score: 199, eps: 0.327\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 324, Best Score: 199, eps: 0.325\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 325, Best Score: 199, eps: 0.323\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 326, Best Score: 199, eps: 0.321\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 327, Best Score: 199, eps: 0.319\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 328, Best Score: 199, eps: 0.317\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 329, Best Score: 199, eps: 0.315\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 330, Best Score: 199, eps: 0.312\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 331, Best Score: 199, eps: 0.310\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 332, Best Score: 199, eps: 0.308\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 333, Best Score: 199, eps: 0.306\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 334, Best Score: 199, eps: 0.304\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 335, Best Score: 199, eps: 0.302\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 336, Best Score: 199, eps: 0.300\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 337, Best Score: 199, eps: 0.298\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 338, Best Score: 199, eps: 0.296\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 339, Best Score: 199, eps: 0.294\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 340, Best Score: 199, eps: 0.292\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 341, Best Score: 199, eps: 0.290\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 342, Best Score: 199, eps: 0.287\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 343, Best Score: 199, eps: 0.285\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 344, Best Score: 199, eps: 0.283\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 345, Best Score: 199, eps: 0.281\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 346, Best Score: 199, eps: 0.279\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 347, Best Score: 199, eps: 0.277\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 348, Best Score: 199, eps: 0.275\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 349, Best Score: 199, eps: 0.273\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 350, Best Score: 199, eps: 0.271\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 351, Best Score: 199, eps: 0.269\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 352, Best Score: 199, eps: 0.267\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 353, Best Score: 199, eps: 0.265\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 354, Best Score: 199, eps: 0.262\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 355, Best Score: 199, eps: 0.260\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 356, Best Score: 199, eps: 0.258\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 357, Best Score: 199, eps: 0.256\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 358, Best Score: 199, eps: 0.254\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 359, Best Score: 199, eps: 0.252\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 360, Best Score: 199, eps: 0.250\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 361, Best Score: 199, eps: 0.248\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 362, Best Score: 199, eps: 0.246\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 363, Best Score: 199, eps: 0.244\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 364, Best Score: 199, eps: 0.242\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 365, Best Score: 199, eps: 0.240\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 366, Best Score: 199, eps: 0.238\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 367, Best Score: 199, eps: 0.235\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 368, Best Score: 199, eps: 0.233\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 369, Best Score: 199, eps: 0.231\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 370, Best Score: 199, eps: 0.229\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 371, Best Score: 199, eps: 0.227\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 372, Best Score: 199, eps: 0.225\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 373, Best Score: 199, eps: 0.223\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 374, Best Score: 199, eps: 0.221\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 375, Best Score: 199, eps: 0.219\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 376, Best Score: 199, eps: 0.217\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 377, Best Score: 199, eps: 0.215\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 378, Best Score: 199, eps: 0.213\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 379, Best Score: 199, eps: 0.210\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 380, Best Score: 199, eps: 0.208\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 381, Best Score: 199, eps: 0.206\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 382, Best Score: 199, eps: 0.204\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 383, Best Score: 199, eps: 0.202\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 384, Best Score: 199, eps: 0.200\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 385, Best Score: 199, eps: 0.198\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 386, Best Score: 199, eps: 0.196\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 387, Best Score: 199, eps: 0.194\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 388, Best Score: 199, eps: 0.192\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 389, Best Score: 199, eps: 0.190\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 390, Best Score: 199, eps: 0.188\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 391, Best Score: 199, eps: 0.185\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 392, Best Score: 199, eps: 0.183\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 393, Best Score: 199, eps: 0.181\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 394, Best Score: 199, eps: 0.179\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 395, Best Score: 199, eps: 0.177\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 396, Best Score: 199, eps: 0.175\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 397, Best Score: 199, eps: 0.173\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 398, Best Score: 199, eps: 0.171\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 399, Best Score: 199, eps: 0.169\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 400, Best Score: 199, eps: 0.167\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 401, Best Score: 199, eps: 0.165\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 402, Best Score: 199, eps: 0.162\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 403, Best Score: 199, eps: 0.160\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 404, Best Score: 199, eps: 0.158\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 405, Best Score: 199, eps: 0.156\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 406, Best Score: 199, eps: 0.154\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 407, Best Score: 199, eps: 0.152\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 408, Best Score: 199, eps: 0.150\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 409, Best Score: 199, eps: 0.148\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 410, Best Score: 199, eps: 0.146\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 411, Best Score: 199, eps: 0.144\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 412, Best Score: 199, eps: 0.142\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 413, Best Score: 199, eps: 0.140\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 414, Best Score: 199, eps: 0.137\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 415, Best Score: 199, eps: 0.135\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 416, Best Score: 199, eps: 0.133\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 417, Best Score: 199, eps: 0.131\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 418, Best Score: 199, eps: 0.129\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 419, Best Score: 199, eps: 0.127\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 420, Best Score: 199, eps: 0.125\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 421, Best Score: 199, eps: 0.123\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 422, Best Score: 199, eps: 0.121\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 423, Best Score: 199, eps: 0.119\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 424, Best Score: 199, eps: 0.117\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 425, Best Score: 199, eps: 0.115\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 426, Best Score: 199, eps: 0.113\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 427, Best Score: 199, eps: 0.110\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 428, Best Score: 199, eps: 0.108\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 429, Best Score: 199, eps: 0.106\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 430, Best Score: 199, eps: 0.104\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 431, Best Score: 199, eps: 0.102\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 432, Best Score: 199, eps: 0.100\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 433, Best Score: 199, eps: 0.098\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 434, Best Score: 199, eps: 0.096\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 435, Best Score: 199, eps: 0.094\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 436, Best Score: 199, eps: 0.092\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 437, Best Score: 199, eps: 0.090\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 438, Best Score: 199, eps: 0.088\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 439, Best Score: 199, eps: 0.085\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 440, Best Score: 199, eps: 0.083\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 441, Best Score: 199, eps: 0.081\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 442, Best Score: 199, eps: 0.079\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 443, Best Score: 199, eps: 0.077\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 444, Best Score: 199, eps: 0.075\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 445, Best Score: 199, eps: 0.073\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 446, Best Score: 199, eps: 0.071\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 447, Best Score: 199, eps: 0.069\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 448, Best Score: 199, eps: 0.067\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 449, Best Score: 199, eps: 0.065\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 450, Best Score: 199, eps: 0.062\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 451, Best Score: 199, eps: 0.060\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 452, Best Score: 199, eps: 0.058\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 453, Best Score: 199, eps: 0.056\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 454, Best Score: 199, eps: 0.054\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 455, Best Score: 199, eps: 0.052\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 456, Best Score: 199, eps: 0.050\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 457, Best Score: 199, eps: 0.048\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 458, Best Score: 199, eps: 0.046\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 459, Best Score: 199, eps: 0.044\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 460, Best Score: 199, eps: 0.042\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 461, Best Score: 199, eps: 0.040\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 462, Best Score: 199, eps: 0.037\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 463, Best Score: 199, eps: 0.035\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 464, Best Score: 199, eps: 0.033\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 465, Best Score: 199, eps: 0.031\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 466, Best Score: 199, eps: 0.029\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 467, Best Score: 199, eps: 0.027\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 468, Best Score: 199, eps: 0.025\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 469, Best Score: 199, eps: 0.023\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 470, Best Score: 199, eps: 0.021\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 471, Best Score: 199, eps: 0.019\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 472, Best Score: 199, eps: 0.017\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 473, Best Score: 199, eps: 0.015\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 474, Best Score: 199, eps: 0.012\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 475, Best Score: 199, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 476, Best Score: 199, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 477, Best Score: 199, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 478, Best Score: 199, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 479, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 480, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 481, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 482, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 483, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 484, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 485, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 486, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 487, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 488, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 489, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 490, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 491, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 492, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 493, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 494, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 495, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 496, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 497, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 498, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 499, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 500, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 501, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 502, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 503, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 504, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 505, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 506, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 507, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 508, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 509, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 510, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 511, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 512, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 513, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 514, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 515, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 516, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 517, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 518, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 519, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 520, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 521, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 522, Best Score: 89, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 523, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 524, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 525, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 526, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 527, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 528, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 529, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 530, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 531, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 532, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 533, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 534, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 535, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 536, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 537, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 538, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 539, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 540, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 541, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 542, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 543, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 544, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 545, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 546, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 547, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 548, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 549, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 550, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 551, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 552, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 553, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 554, Best Score: 88, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 555, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 556, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 557, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 558, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 559, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 560, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 561, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 562, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 563, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 564, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 565, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 566, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 567, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 568, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 569, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 570, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 571, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 572, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 573, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 574, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 575, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 576, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 577, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 578, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 579, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 580, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 581, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 582, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 583, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 584, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 585, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 586, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 587, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 588, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 589, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 590, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 591, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 592, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 593, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 594, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 595, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 596, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 597, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 598, Best Score: 85, eps: 0.010\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\rEpisode: 599, Best Score: 85, eps: 0.010\n```\n:::\n:::\n\n\nIn the figure below, you can see that it took about 330 episodes for the car to reach the goal for the first time. As training progressed, the score improved for a short time but then went back to 200. That happened a number of times, too. This is what Aurélien Géron describes as \"catastrophic forgetting\", which makes me laugh but describes it perfectly.\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\nimport plotly.express as px\n\nfig = px.line(x=[i for i in range(len(rewards))], y=rewards)\nfig.update_layout(xaxis_title='Episode', yaxis_title='Score')\nfig.show()\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>                            <div id=\"c6adfc34-98f8-49a2-999d-c71be1f2d550\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                require([\"plotly\"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById(\"c6adfc34-98f8-49a2-999d-c71be1f2d550\")) {                    Plotly.newPlot(                        \"c6adfc34-98f8-49a2-999d-c71be1f2d550\",                        [{\"hovertemplate\":\"x=%{x}<br>y=%{y}<extra></extra>\",\"legendgroup\":\"\",\"line\":{\"color\":\"#636efa\",\"dash\":\"solid\"},\"marker\":{\"symbol\":\"circle\"},\"mode\":\"lines\",\"name\":\"\",\"orientation\":\"v\",\"showlegend\":false,\"x\":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599],\"xaxis\":\"x\",\"y\":[199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,89,146,92,157,142,176,107,111,114,199,123,134,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,138,147,146,105,199,91,199,88,199,199,199,199,199,199,199,199,199,199,115,165,162,164,199,199,199,199,199,199,199,199,199,164,101,124,161,194,173,167,199,85,199,199,199,199,199,199,199,199,199,199,199,199,199,101,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,199,119,166,163,166,95,92],\"yaxis\":\"y\",\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"histogram2dcontour\":[{\"type\":\"histogram2dcontour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"choropleth\":[{\"type\":\"choropleth\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"histogram2d\":[{\"type\":\"histogram2d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmap\":[{\"type\":\"heatmap\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"heatmapgl\":[{\"type\":\"heatmapgl\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"contourcarpet\":[{\"type\":\"contourcarpet\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"contour\":[{\"type\":\"contour\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"surface\":[{\"type\":\"surface\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]}],\"mesh3d\":[{\"type\":\"mesh3d\",\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}],\"scatter\":[{\"fillpattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2},\"type\":\"scatter\"}],\"parcoords\":[{\"type\":\"parcoords\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolargl\":[{\"type\":\"scatterpolargl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"scattergeo\":[{\"type\":\"scattergeo\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterpolar\":[{\"type\":\"scatterpolar\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"scattergl\":[{\"type\":\"scattergl\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatter3d\":[{\"type\":\"scatter3d\",\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattermapbox\":[{\"type\":\"scattermapbox\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scatterternary\":[{\"type\":\"scatterternary\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"scattercarpet\":[{\"type\":\"scattercarpet\",\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}}}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"minorgridcolor\":\"white\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}],\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"#E5ECF6\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}]},\"layout\":{\"autotypenumbers\":\"strict\",\"colorway\":[\"#636efa\",\"#EF553B\",\"#00cc96\",\"#ab63fa\",\"#FFA15A\",\"#19d3f3\",\"#FF6692\",\"#B6E880\",\"#FF97FF\",\"#FECB52\"],\"font\":{\"color\":\"#2a3f5f\"},\"hovermode\":\"closest\",\"hoverlabel\":{\"align\":\"left\"},\"paper_bgcolor\":\"white\",\"plot_bgcolor\":\"#E5ECF6\",\"polar\":{\"bgcolor\":\"#E5ECF6\",\"angularaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"radialaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"ternary\":{\"bgcolor\":\"#E5ECF6\",\"aaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"},\"caxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\"}},\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"sequential\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]]},\"xaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"yaxis\":{\"gridcolor\":\"white\",\"linecolor\":\"white\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"white\",\"automargin\":true,\"zerolinewidth\":2},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"yaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2},\"zaxis\":{\"backgroundcolor\":\"#E5ECF6\",\"gridcolor\":\"white\",\"linecolor\":\"white\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"white\",\"gridwidth\":2}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"geo\":{\"bgcolor\":\"white\",\"landcolor\":\"#E5ECF6\",\"subunitcolor\":\"white\",\"showland\":true,\"showlakes\":true,\"lakecolor\":\"white\"},\"title\":{\"x\":0.05},\"mapbox\":{\"style\":\"light\"}}},\"xaxis\":{\"anchor\":\"y\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Episode\"}},\"yaxis\":{\"anchor\":\"x\",\"domain\":[0.0,1.0],\"title\":{\"text\":\"Score\"}},\"legend\":{\"tracegroupgap\":0},\"margin\":{\"t\":60}},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('c6adfc34-98f8-49a2-999d-c71be1f2d550');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };                });            </script>        </div>\n```\n:::\n:::\n\n\nAccording to the documentation for this environment, MountainCar-v0 is considered \"solved\" when the agent obtains an average reward of at least -110.0 over 100 consecutive episodes. That would translate into a score of 110 or less over 100 episodes. The best score here was 82, and looking at the graph, the NN didn't maintain anything less than 200 very long, so there's still work to do. I'll go with what I have for now and demonstrate how the NN does visually.\n\nNext, I'll trained the model for 2000 episodes. I'm not going to re-run that code here because it took hours, and I've also been having an issue with Python kernel dying while rendering this page that I haven't overcome yet. Instead, below is a plot of the results from when I originally trained the model.\n\n![Results after training for 2000 episodes.](2000_episodes.png){width=\"600\"}\n\nThis is much better than the previous results! The NN held a sub-200 score for quite a few episodes towards the end of training. However, the best score wasn't consistently below 110, so there's still more work to do. There is no incentive for reaching to goal quickly, so maybe I can get better results by adding a large reward for finishing in fewer than 110 steps. The problem with that approach is that training is conducted on a random sampling of 64 experiences out of the 2000 that are in the replay memory deque. Sub-110 scores are rare, so the chances of that reward making it into the training set is remote. Probably a better approach is to improve the NN performance so that sub-110 scores are more common. That might be possible by playing around with tuning parameters or maybe switching to a different type of reinforcement learning method like a Dueling Deep Q-Network or a Double Dueling Deep Q-Network. That's for another post, though.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n        <script type=\"text/javascript\">\n        window.PlotlyConfig = {MathJaxConfig: 'local'};\n        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n        if (typeof require !== 'undefined') {\n        require.undef(\"plotly\");\n        requirejs.config({\n            paths: {\n                'plotly': ['https://cdn.plot.ly/plotly-2.16.1.min']\n            }\n        });\n        require(['plotly'], function(Plotly) {\n            window._Plotly = Plotly;\n        });\n        }\n        </script>\n        \n"
      ]
    }
  }
}